# Быстрая проверка SMTP сервера

## Шаг 1: Проверьте, что сервер запущен

```bash
# Запустите сервер
go run cmd/api/main.go

# Должны увидеть:
# "SMTP-сервер запущен на порту 2525"
# "Домен: tempmail.dev"
```

## Шаг 2: Проверьте порт

**Windows PowerShell:**
```powershell
netstat -an | Select-String ":2525"
```

**Linux/Mac:**
```bash
netstat -an | grep 2525
```

Если порт не слушается - сервер не запущен.

## Шаг 3: Создайте тестовый ящик

```bash
# Через API
curl -X POST http://localhost:8080/api/v1/mailbox

# Сохраните ID и address из ответа
```

## Шаг 4: Отправьте тестовое письмо

```bash
# Используйте тестовый скрипт
cd server
go run scripts/test-smtp.go localhost 2525 ваш-адрес@tempmail.dev
```

Или через telnet:
```bash
telnet localhost 2525
```

В telnet введите:
```
EHLO test
MAIL FROM:<test@example.com>
RCPT TO:<ваш-адрес@tempmail.dev>
DATA
Subject: Test

Тест
.
QUIT
```

## Шаг 5: Проверьте письмо через API

```bash
# Получите список писем
curl http://localhost:8080/api/v1/mailbox/{id}/messages
```

## Важно для получения писем из интернета

Если вы отправляете письмо с Gmail/Outlook и оно не приходит:

1. **SMTP сервер работает только локально** - для получения писем из интернета нужно:
   - Настроить DNS (MX записи)
   - Открыть порт 25 в файрволе
   - Изменить `SMTP_PORT=25` (стандартный SMTP порт)

2. **Проверьте домен:**
   ```bash
   # Домен в ящике должен совпадать с MAIL_DOMAIN
   MAIL_DOMAIN=tempmail.dev  # или ваш домен
   ```

3. **Проверьте логи сервера** - при получении письма должны быть записи:
   - "Новое SMTP-соединение от ..."
   - "MAIL FROM: ..."
   - "RCPT TO: ..."
   - "Получение данных письма..."

## Частые проблемы

### "Почтовый ящик не найден"
- Убедитесь, что ящик создан через API
- Проверьте, что домен совпадает с `MAIL_DOMAIN`
- Проверьте, что ящик не истёк

### Письма не приходят из интернета
- SMTP сервер работает только локально
- Нужны DNS записи (MX) и открытый порт 25
- Многие провайдеры блокируют порт 25

### Ошибка подключения
- Проверьте, что сервер запущен
- Проверьте порт (по умолчанию 2525)
- Проверьте файрвол

Подробнее: см. `docs/SMTP_TROUBLESHOOTING.md`

